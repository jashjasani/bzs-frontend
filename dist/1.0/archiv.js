function getC(e){let t=e+"=";e=document.cookie.split("; ");let n="";return e.forEach(e=>{0===e.indexOf(t)&&(n=e.substring(t.length))}),n}let randomMags=async e=>{for(var t=e.length-1;0<t;t--){var n=Math.floor(Math.random()*(t+1)),a=e[t];e[t]=e[n],e[n]=a}return e};async function renderData(e){if(0!=e.count){var t=document.getElementsByClassName("w-dyn-items w-row")[0];t&&(t.style.display="block");document.getElementsByClassName("no-results-wrapper")[0].style.display="none";var o,t=document.getElementsByClassName("results-count")[0],l=document.createElement("div"),s=(l.className="results-count",document.createElement("span")),c=(s.textContent=e.count+" Ergebnisse von ",document.createElement("span")),m=(c.textContent=e.totalCount,l.append(s,c),t.replaceWith(l),document.createDocumentFragment()),s=document.getElementsByClassName("w-dyn-list")[0];document.getElementsByClassName("w-dyn-items w-row")[0]&&(o=document.getElementsByClassName("w-dyn-items w-row")[0]).remove(),(o=document.createElement("div")).className="w-dyn-items w-row";let n,a,r=(null!=sessionStorage.getItem("auth")&&(n=await(n=await fetch("https://bildzeitschrift.netlify.app/.netlify/functions/collection",{method:"GET",headers:{Authorization:sessionStorage.getItem("auth")}})).json(),a=n.subscription||null,n=n.collections,sessionStorage.setItem("collections",JSON.stringify(Array.from(n)))),0);for(q of e.magazines){var d=document.createElement("div"),p=(d.className="archive-col-item w-dyn-item w-col w-col-3",document.createElement("a")),u=(p.href=new URL(document.baseURI).origin+"/magazine?productId="+q.SKU,p.className="produvt-img-wrapper w-inline-block",p.id=q.SKU,p.style.zIndex="0",p.style.position="relative",document.createElement("img"));u.className="product-img",u.src="https://res.cloudinary.com/wdy-bzs/image/upload/q_15/v1651695832/"+q.Images,u.loading=r<=10?"eager":"lazy",r++,u.alt="product-img";let e="",t="";sessionStorage.getItem("auth")&&null!=a&&a.end_date>Math.floor(Date.now()/1e3)&&"Inspiration"==a.plan&&(document.querySelector(".filter-info").style.display="none",(e=document.createElement("button")).className="btn-specihern left-btn",e.innerText="...",(t=document.createElement("button")).className="btn-specihern",t.innerText=n.some(e=>e.items.includes(q.SKU))?"Gespeichert":"Speichern",e.addEventListener("click",t=>{if(t.preventDefault(),null==t.target.parentElement.querySelector(".container-mode")){null!=document.querySelector("#container-main")&&document.querySelector("#container-main").remove();var n=document.createElement("div"),e=(n.id="container-main",n.className="container-mode",new URL(t.target.parentElement.href)),e=(n.setAttribute("dropdown-key",new URLSearchParams(e.search).get("productId")),document.createElement("input"));if(e.placeholder="Suchen ...",e.className="collection-search",e.addEventListener("input",t=>{var n=t.target.parentElement.querySelectorAll(".collections");if(""==t.target.value)for(let e=0;e<n.length-1;e++)n[e].style.display="flex";for(let e=0;e<n.length-1;e++)n[e].innerText.toLowerCase().startsWith(t.target.value.toLowerCase())?n[e].innerText.toLowerCase().startsWith(t.target.value.toLowerCase())&&"none"==n[e].style.display&&(n[e].style.display="flex"):n[e].style.display="none"}),n.appendChild(e),sessionStorage.getItem("collections")){let a=JSON.parse(sessionStorage.getItem("collections"));for(let e=0;e<a.length;e++){var r=document.createElement("div"),i=(r.className="collections",document.createElement("div")),o=(i.className="collection-name",i.style.marginLeft="10px",i.innerText=a[e].name,document.createElement("button"));o.className="collection-btn",o.style.visibility="visible",o.innerText=a[e].items.includes(t.target.parentElement.href.split("?productId=")[1])?"saved":"+",o.addEventListener("click",n=>{var t;n.target.parentElement.parentElement.parentElement.querySelector(".btn-specihern.left-btn").innerText=a[e].name,"+"==n.target.innerText?(t=a.find(e=>e.name==n.target.parentElement.childNodes[0].innerText),fetch("https://bildzeitschrift.netlify.app/.netlify/functions/collection",{method:"PUT",headers:{Authorization:sessionStorage.getItem("auth")},body:JSON.stringify({name:n.target.parentElement.childNodes[0].innerText,update:{$addToSet:{items:n.target.parentElement.parentElement.getAttribute("dropdown-key")},...t.hasOwnProperty("cover")?{}:{$set:{cover:n.target.parentElement.parentElement.parentElement.querySelector(".product-img").src.split("/v1651695832/")[1]}}}})}).then(e=>{200==e.status&&((t=a.find(e=>e.name==n.target.parentElement.childNodes[0].innerText)).hasOwnProperty("cover")&&(t.cover=n.target.parentElement.parentElement.parentElement.querySelector(".product-img").src.split("/v1651695832/")[1]),t.items.push(n.target.parentElement.parentElement.getAttribute("dropdown-key")),n.target.innerText="saved",sessionStorage.setItem("collections",JSON.stringify(a)),a.some(e=>e.items.includes(n.target.parentElement.parentElement.getAttribute("dropdown-key")))?n.target.parentElement.parentElement.parentElement.querySelector(".btn-specihern").innerText="Gespeichert":n.target.parentElement.parentElement.parentElement.querySelector(".btn-specihern").innerText="Speichern",document.querySelectorAll(".btn-specihern.left-btn").forEach(e=>{e.innerText=n.target.parentElement.childNodes[0].innerText}))})):fetch("https://bildzeitschrift.netlify.app/.netlify/functions/collection",{method:"PUT",headers:{Authorization:sessionStorage.getItem("auth")},body:JSON.stringify({name:n.target.parentElement.childNodes[0].innerText,update:{$pull:{items:n.target.parentElement.parentElement.getAttribute("dropdown-key")}}})}).then(e=>{var t;200==e.status&&(-1<(t=(e=a.find(e=>e.name==n.target.parentElement.childNodes[0].innerText)).items.indexOf(n.target.parentElement.parentElement.getAttribute("dropdown-key")))&&(e.items.splice(t,1),sessionStorage.setItem("collections",JSON.stringify(a))),n.target.innerText="+",a.some(e=>e.items.includes(n.target.parentElement.parentElement.getAttribute("dropdown-key")))?n.target.parentElement.parentElement.parentElement.querySelector(".btn-specihern").innerText="Gespeichert":n.target.parentElement.parentElement.parentElement.querySelector(".btn-specihern").innerText="Speichern")})}),r.appendChild(i),r.appendChild(o),n.appendChild(r)}}var e=document.createElement("div"),a=(e.className="collections",document.createElement("button")),l=(a.innerText="+",a.className="collection-btn",a.style.visibility="visible",a.addEventListener("click",async t=>{let n=await Swal.fire({title:"Neue Kollektion",input:"text",inputLabel:"Name",inputPlaceholder:"Name deiner neuen Kollektion",confirmButtonText:"Erstellen",showCloseButton:!0,inputValidator:e=>{if(!e)return"Name cannot be empty"}}),a=JSON.parse(sessionStorage.getItem("collections"));a.some(e=>e.name==n.value)||null==n.value||fetch("https://bildzeitschrift.netlify.app/.netlify/functions/collection",{method:"POST",headers:{Authorization:sessionStorage.getItem("auth")},body:JSON.stringify({name:n.value,item:t.target.parentElement.parentElement.getAttribute("dropdown-key")})}).then(e=>{200==e.status&&((e={name:n.value,items:[],cover:t.target.parentElement.parentElement.getAttribute("dropdown-key").replaceAll("-","_").replaceAll("(","").replaceAll(")","")}).items.push(t.target.parentElement.parentElement.getAttribute("dropdown-key")),document.getElementById(""+t.target.parentElement.parentElement.getAttribute("dropdown-key")).querySelector(".btn-specihern").innerText="Gerettet",document.querySelectorAll(".btn-specihern.left-btn").forEach(e=>{e.innerText=n.value}),a.push(e),sessionStorage.setItem("collections",JSON.stringify(a)))})}),document.createElement("div"));l.className="collection-name",l.innerText="Kollektion erstellen",l.style.marginLeft="10px",e.appendChild(a),e.appendChild(l),n.appendChild(e),n.addEventListener("click",e=>{e.preventDefault()}),t.target.insertAdjacentElement("afterend",n)}else t.target.parentElement.querySelector(".container-mode").remove()}),document.addEventListener("click",e=>{e.target.closest("#container-main")||null==document.querySelector("#container-main")||"btn-specihern left-btn"==e.target.className||document.querySelector("#container-main").remove()}),t.addEventListener("click",e=>{e.preventDefault()}),p.addEventListener("mouseover",()=>{e.style.visibility="visible",t.style.visibility="visible"}),p.addEventListener("mouseout",()=>{e.style.visibility="hidden",t.style.visibility="hidden"}));var g=document.createElement("div"),y=(g.className="product-title",21<q.Name.length?g.innerText=q.Name.slice(0,18)+"...":g.innerText=q.Name,g.setAttribute("fs-cmsfilter-field","Titel"),document.createElement("div")),h=(y.className="issue-wrapper",document.createElement("div")),E=(h.className="month",h.innerText=q.Monat+" | ",document.createElement("div")),f=(E.className="date-divider",document.createElement("div")),w=(f.className="year",f.innerText=" "+q.Jahr+" Ausgabe "+q.Ausgabe,document.createElement("div"));w.className="decade",y.append(h,E,f,w),"Special"==q.Bewertung&&((h=document.createElement("img")).src="https://res.cloudinary.com/wdy-bzs/image/upload/v1661106376/asset/special_icon",h.className="special-img",p.append(h)),p.append(u,t,e,g,y),d.append(p),d.setAttribute("role","listitem"),m.append(d)}o.append(m),s.prepend(o);var b,v,N,c=document.getElementsByClassName("w-dyn-list")[0],x=(document.getElementsByClassName("w-pagination-wrapper pagination")[0]&&(b=document.getElementsByClassName("w-pagination-wrapper pagination")[0]).remove(),(b=document.createElement("div")).className="w-pagination-wrapper pagination",b.style.display="flex",e.pageCount),C=e.currentPage||1,S=getC("lastQuery"),k=document.createDocumentFragment();if(1!=C&&(10<C&&((N=document.createElement("a")).className="w-pagination-previous pagination-button-left keep-params 10xarrow",N.setAttribute("aria-label","Previous Page"),N.style.marginRight=0,(v=document.createElement("img")).width="45",v.loading="lazy",v.src="https://res.cloudinary.com/wdy-bzs/image/upload/v1661106376/asset/Group_42_1.svg",v.className="pagination-arrow left",N.style.marginRight="0px",N.style.paddingRight="0px",N.append(v),k.append(N),N.href=""!=S?"?page="+(C-10)+"&"+S:"?page="+(C-10)),(v=document.createElement("a")).className="w-pagination-previous pagination-button-left keep-params 10xarrow",v.setAttribute("aria-label","Previous Page"),(N=document.createElement("img")).width="45",N.loading="lazy",N.src="https://res.cloudinary.com/wdy-bzs/image/upload/v1651849092/asset/Arrow.svg",N.className="pagination-arrow left",v.style.paddingLeft="0px",v.style.paddingRight="0px",v.append(N),k.append(v),v.href=""!=S?"?page="+(C-1)+"&"+S:"?page="+(C-1)),x<=7)for(i=1;i<=x;i++){var T=document.createElement("a"),A=document.createElement("div");A.textContent=i,T.className="pagination-page-button w-inline-block",T.href=""!=S?"?page="+i+"&"+S:"?page="+i,T.append(A),k.append(T),i==C&&(T.className="pagination-page-button w-inline-block w--current")}else if(C<5){for(i=1;i<=5;i++){var L=document.createElement("a"),B=document.createElement("div");B.textContent=i,L.className="pagination-page-button w-inline-block",L.href=""!=S?"?page="+i+"&"+S:"?page="+i,L.append(B),k.append(L),i==C&&(L.className="pagination-page-button w-inline-block w--current")}var z=document.createElement("div"),z=(z.textContent="...",z.className="pagination-dots-button",k.append(z),document.createElement("a")),I=document.createElement("div");I.textContent=x,z.className="pagination-page-button w-inline-block",z.href=""!=S?"?page="+x+"&"+S:"?page="+x,z.append(I),k.append(z)}else if(5<=C&&C<=x-4){var I=document.createElement("a"),z=document.createElement("div"),D=(z.textContent="1",I.className="pagination-page-button w-inline-block",I.href=""!=S?"?page=1&"+S:"?page=1",I.append(z),k.append(I),document.createElement("div")),O=(D.textContent="...",D.className="pagination-dots-button",k.append(D),C-1);for(i=0;i<3;i++){var P=document.createElement("a"),_=document.createElement("div");_.textContent=O,P.className="pagination-page-button w-inline-block",P.href=""!=S?"?page="+O+"&"+S:"?page="+O,P.append(_),k.append(P),O==C&&(P.className="pagination-page-button w-inline-block w--current"),O+=1}var D=document.createElement("div"),D=(D.textContent="...",D.className="pagination-dots-button",k.append(D),document.createElement("a")),U=document.createElement("div");U.textContent=x,D.className="pagination-page-button w-inline-block",D.href=""!=S?"?page="+i+"&"+S:"?page="+i,D.append(U),k.append(D)}else{var U=document.createElement("a"),D=document.createElement("div"),F=(D.textContent="1",U.className="pagination-page-button w-inline-block",U.href=""!=S?"?page=1&"+S:"?page=1",U.append(D),k.append(U),document.createElement("div"));for(F.textContent="...",F.className="pagination-dots-button",k.append(F),i=x-4;i<=x;i++){var M=document.createElement("a"),R=document.createElement("div");R.textContent=i,M.className="pagination-page-button w-inline-block",M.href=""!=S?"?page="+i+"&"+S:"?page="+i,M.append(R),k.append(M),i==C&&(M.className="pagination-page-button w-inline-block w--current"),O++}}return b.append(k),C!=x&&((F=document.createElement("a")).className="w-pagination-right pagination-button-next keep-params 10xarrow",F.setAttribute("aria-label","Next Page"),t=document.createElement("img"),F.style.marginLeft=10,t.width="45",t.loading="lazy",t.src="https://res.cloudinary.com/wdy-bzs/image/upload/v1651849092/asset/Arrow.svg",t.className="pagination-arrow right",F.append(t),F.href=""!=S?"?page="+parseInt(Number(C)+1)+"&"+S:"?page="+parseInt(Number(C)+1),b.append(F),10<=x-C)&&((t=document.createElement("a")).className="w-pagination-right pagination-button-next keep-params 10xarrow",t.setAttribute("aria-label","Next Page"),(l=document.createElement("img")).style,l.width="45",t.style.marginLeft="0px",l.loading="lazy",l.src="https://res.cloudinary.com/wdy-bzs/image/upload/v1661106376/asset/Group_42_1.svg",l.className="pagination-arrow right",t.append(l),t.href=""!=S?"?page="+parseInt(Number(C)+10)+"&"+S:"?page="+parseInt(Number(C)+10),b.append(t)),c.append(b),await 0,""==getC("lastQuery")&&fetch("https://bildzeitschrift.netlify.app/.netlify/functions/randomize").catch(),a}document.getElementsByClassName("collection-list w-dyn-items w-row")[0].style.display="none",document.getElementsByClassName("no-results-wrapper")[0].style.display="block"}async function loadFData(e){var t,n;"Enter"==e?.key&&(t=document.getElementsByClassName("search-field w-input")[0].value.trim(),n=new URL(window.location.href),""==t||null==t?n.searchParams.delete("search"):n.searchParams.set("search",t),window.history.replaceState({},document.title,n.href)),e&&"Enter"!=e.key||(n=new URL(window.location.href)).searchParams.get("search")&&(document.getElementsByClassName("search-field w-input")[0].value=String(n.searchParams.get("search"))),setTimeout(async()=>{{var t,n,a,r,i,o,l=window.location.href,s=l.split("?")[1];let e="";s&&(e=s.includes("page")?s.split("&").slice(1).join("&"):s),document.cookie="lastQuery="+e;try{let e;if(0===(e=1<l.split("?").length?(t=getC("randomNumber"),n=getC("sort_random"),a=getC("selection_exclude"),await(await fetch(`https://bildzeitschrift.netlify.app/.netlify/functions/loadData?randomNumber=${t}&sort_toggle=${n}&selectExcl=${a}&`+s,{headers:{Authorization:sessionStorage.getItem("auth")}})).json()):(r=getC("sort_random"),i=getC("randomOrder"),o=getC("selection_exclude"),await(await fetch(`https://bildzeitschrift.netlify.app/.netlify/functions/loadData?page=1&sort_toggle=${r}&selectExcl=${o}&randomOrder=`+i,{headers:{Authorization:sessionStorage.getItem("auth")}})).json())).count){document.getElementsByClassName("w-dyn-items w-row")[0].style.display="none";var c=document.getElementsByClassName("results-count")[0],m=(c.innerHTML="",document.createElement("span")),d=(m.textContent=e.count+" Ergebnisse von ",document.createElement("span"));d.textContent=e.totalCount,c.append(m,d),document.getElementsByClassName("no-results-wrapper")[0].style.display="block",document.getElementsByClassName("w-pagination-wrapper pagination")[0].style.display="none"}else{await renderData(e);e.currentPage>e.pageCount&&document.getElementsByClassName("pagination-page-button w-inline-block")[0].click()}}catch(e){console.error("Error:",e)}}},100)}document.addEventListener("DOMContentLoaded",async function(){let e="true";var t=document.getElementsByClassName("random-switch")[0],n=(document.querySelector(".results-tag_wrapper").addEventListener("mouseup",loadFData),document.getElementsByClassName("toggle")[0],""!=getC("sort_random")?e=getC("sort_random"):document.cookie="sort_random="+e+";","false"==e&&t.click(),(new Date).getTime()),n=new Date(n+6e5),a=Math.floor(5*Math.random()),r=0==Math.floor(2*Math.random())?-1:1,r=(""==getC("randomOrder")&&""==getC("randomNumber")&&(document.cookie="randomOrder="+r+";path=/;expires="+n.toUTCString(),document.cookie="randomNumber="+a+";path=/;expires="+n.toUTCString()),await loadFData(),document.getElementsByClassName("reset-btn w-inline-block"));for(x of r)x.addEventListener("mouseup",loadFData);for(s of document.getElementsByClassName("dropdown-btn-wrapper"))s.addEventListener("mouseup",loadFData);for(ind of document.querySelectorAll(".filter-dropdown.single"))ind.addEventListener("mouseup",loadFData);a=document.getElementsByClassName("checkbox-element-wrapper"),n=document.getElementsByClassName("reset-all-btn")[0];n.addEventListener("mouseup",()=>{var e=new URL(window.location.href);window.location.assign(e.origin+e.pathname)}),n.href="#";for(q of a)q.addEventListener("mouseup",loadFData);document.getElementsByClassName("search-field w-input")[0].addEventListener("keypress",e=>{"Enter"==e.key&&loadFData(e)}),t.addEventListener("click",()=>{e="false"==e?"true":"false",document.cookie="sort_random="+e+";",loadFData()})});